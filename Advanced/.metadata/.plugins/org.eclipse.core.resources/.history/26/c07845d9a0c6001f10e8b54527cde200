package com.tiltdev.multitouchtest.utils;

import java.io.IOException;
import java.io.InputStream;

import javax.microedition.khronos.opengles.GL10;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.opengl.GLUtils;

public class TextureLoader {
	private int[] mTextures;
	
	public int[] getTextures() {
		return mTextures;
	}
	
	/**
	 * Loads Bitmap into GL-friendly texture format.
	 * @param gl
	 * @param context
	 * @param resource
	 */
	public void loadGLTexture(GL10 gl, Context context, int resource) {
		InputStream is = context.getResources().openRawResource(resource);
		Bitmap bitmap = null;
		try {
			bitmap = BitmapFactory.decodeStream(is);
			is.close();
			is = null;
		} catch (IOException e) {
			//Normally we'd put some sort of error message here, such as "Texture Load Error"
		}

		gl.glGenTextures(1, mTextures, 0);
		gl.glBindTexture(GL10.GL_TEXTURE_2D, mTextures[0]);
		
		gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, GL10.GL_NEAREST);
		gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, GL10.GL_LINEAR);
		gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S, GL10.GL_REPEAT);
		gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T, GL10.GL_REPEAT);
		
		
		GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0);
		bitmap.recycle();
	}
}
